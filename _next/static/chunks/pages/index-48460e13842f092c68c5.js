(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{510:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return P}});var r,a=t(5893),u=t(9008),i=t(7294),o=t(809),s=t.n(o);function c(e,n,t,r,a,u,i){try{var o=e[u](i),s=o.value}catch(c){return void t(c)}o.done?n(s):Promise.resolve(s).then(r,a)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var u=e.apply(n,t);function i(e){c(u,r,a,i,o,"next",e)}function o(e){c(u,r,a,i,o,"throw",e)}i(void 0)}))}}var d=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});d.decode();var f=null;function p(){return null!==f&&f.buffer===r.memory.buffer||(f=new Uint8Array(r.memory.buffer)),f}function _(e,n){return d.decode(p().subarray(e,e+n))}var b=new Array(32).fill(void 0);b.push(void 0,null,!0,!1);var m=b.length;function h(e){m===b.length&&b.push(b.length+1);var n=m;return m=b[n],b[n]=e,n}function v(e){var n=function(e){return b[e]}(e);return function(e){e<36||(b[e]=m,m=e)}(e),n}function w(){return r.get_x_size()>>>0}function g(){return r.get_y_size()>>>0}var x=null;function y(){return null!==x&&x.buffer===r.memory.buffer||(x=new Int32Array(r.memory.buffer)),x}function j(e,n){try{var t=r.__wbindgen_add_to_stack_pointer(-16);r.get_calculated_item(t,e,n);var a=y()[t/4+0],u=y()[t/4+1];return _(a,u)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(a,u)}}var k=0,N=new TextEncoder("utf-8"),C="function"===typeof N.encodeInto?function(e,n){return N.encodeInto(e,n)}:function(e,n){var t=N.encode(e);return n.set(t),{read:e.length,written:t.length}};function R(e,n,t){var a=function(e,n,t){if(void 0===t){var r=N.encode(e),a=n(r.length);return p().subarray(a,a+r.length).set(r),k=r.length,a}for(var u=e.length,i=n(u),o=p(),s=0;s<u;s++){var c=e.charCodeAt(s);if(c>127)break;o[i+s]=c}if(s!==u){0!==s&&(e=e.slice(s)),i=t(i,u,u=s+3*e.length);var l=p().subarray(i+s,i+u);s+=C(e,l).written}return k=s,i}(t,r.__wbindgen_malloc,r.__wbindgen_realloc),u=k;return v(r.update_item(e,n,a,u))}function E(){try{var e=r.__wbindgen_add_to_stack_pointer(-16);r.export_raw_table(e);var n=y()[e/4+0],t=y()[e/4+1];return _(n,t)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(n,t)}}function S(){try{var e=r.__wbindgen_add_to_stack_pointer(-16);r.export_calculated_table(e);var n=y()[e/4+0],t=y()[e/4+1];return _(n,t)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(n,t)}}function A(e,n){return I.apply(this,arguments)}function I(){return(I=l(s().mark((function e(n,t){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("function"===typeof Response&&n instanceof Response)){e.next=23;break}if("function"!==typeof WebAssembly.instantiateStreaming){e.next=15;break}return e.prev=2,e.next=5,WebAssembly.instantiateStreaming(n,t);case 5:return e.abrupt("return",e.sent);case 8:if(e.prev=8,e.t0=e.catch(2),"application/wasm"==n.headers.get("Content-Type")){e.next=14;break}console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e.t0),e.next=15;break;case 14:throw e.t0;case 15:return e.next=17,n.arrayBuffer();case 17:return r=e.sent,e.next=20,WebAssembly.instantiate(r,t);case 20:return e.abrupt("return",e.sent);case 23:return e.next=25,WebAssembly.instantiate(n,t);case 25:if(!((a=e.sent)instanceof WebAssembly.Instance)){e.next=30;break}return e.abrupt("return",{instance:a,module:n});case 30:return e.abrupt("return",a);case 31:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function U(e){return L.apply(this,arguments)}function L(){return(L=l(s().mark((function e(n){var a,u,i,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"undefined"===typeof n&&(n=new URL(t(3439),t.b)),(a={}).wbg={},a.wbg.__wbindgen_string_new=function(e,n){return h(_(e,n))},a.wbg.__wbindgen_rethrow=function(e){throw v(e)},("string"===typeof n||"function"===typeof Request&&n instanceof Request||"function"===typeof URL&&n instanceof URL)&&(n=fetch(n)),e.t0=A,e.next=9,n;case 9:return e.t1=e.sent,e.t2=a,e.next=13,(0,e.t0)(e.t1,e.t2);case 13:return u=e.sent,i=u.instance,o=u.module,r=i.exports,U.__wbindgen_wasm_module=o,e.abrupt("return",r);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=U;function O(e,n){for(var t=[],r=0;r<n;r++){for(var a=[],u=0;u<e;u++)a.push(j(u,r));t.push(a)}return t}var P=function(){var e=(0,i.useState)(!1),n=e[0],t=e[1],o=(0,i.useState)(0),s=o[0],c=o[1],l=(0,i.useState)(0),d=l[0],f=l[1],p=(0,i.useState)([]),b=p[0],m=p[1],h=(0,i.useState)(0),x=h[0],j=h[1],k=(0,i.useState)(0),N=k[0],C=k[1],A=(0,i.useState)(""),I=A[0],U=A[1],L=(0,i.useState)(!1),P=L[0],T=L[1],B=(0,i.useState)(""),X=B[0],M=B[1],V=(0,i.useState)(0),q=V[0],z=V[1];return(0,i.useEffect)((function(){n&&U(function(e,n){try{var t=r.__wbindgen_add_to_stack_pointer(-16);r.get_raw_item(t,e,n);var a=y()[t/4+0],u=y()[t/4+1];return _(a,u)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(a,u)}}(x,N))}),[x,N,b]),(0,i.useEffect)((function(){T(n&&0<=x&&x<s&&0<=N&&N<d)}),[b,x,N,s,d]),(0,i.useEffect)((function(){W("/csvx.wasm").then((function(e){e,t(!0),c(w()),f(g())}))}),[]),(0,i.useEffect)((function(){m(O(s,d))}),[s,d]),(0,i.useEffect)((function(){0!=b.length&&0!=b[0].length&&0<=x&&x<s&&0<=N&&N<d&&(R(x,N,I),m(O(s,d)))}),[I]),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.default,{children:(0,a.jsx)("title",{children:"Home | CSVX"})}),(0,a.jsx)("div",{className:"pure-form pure-g",children:(0,a.jsxs)("fieldset",{children:[(0,a.jsx)("legend",{className:"pure-u-1",children:"Edit"}),(0,a.jsx)("input",{value:x,onChange:function(e){j(Number.parseInt(e.target.value))},type:"number",min:"0",placeholder:"x",className:"pure-u-1-12"}),(0,a.jsx)("input",{value:N,onChange:function(e){C(Number.parseInt(e.target.value))},type:"number",min:"0",placeholder:"y",className:"pure-u-1-12"}),(0,a.jsx)("input",{value:I,onChange:function(e){U(e.target.value)},type:"text",placeholder:"value or formula",className:"pure-u-5-6",disabled:!P})]})}),(0,a.jsx)("div",{className:"pure-form pure-g",children:(0,a.jsxs)("fieldset",{children:[(0,a.jsx)("legend",{className:"pure-u-1",children:"Insert / Remove"}),(0,a.jsxs)("select",{value:X,onChange:function(e){return M(e.target.value)},className:"pure-u-1-4",children:[(0,a.jsx)("option",{disabled:!0,value:"",children:"Please Select"}),(0,a.jsx)("option",{children:"Row"}),(0,a.jsx)("option",{children:"Column"})]}),(0,a.jsx)("input",{value:q,onChange:function(e){return z(Number.parseInt(e.target.value))},type:"number",min:"0",placeholder:"position",className:"pure-u-1-4"}),(0,a.jsxs)("div",{className:"pure-button-group pure-u-1-2",role:"group",children:[(0,a.jsx)("button",{className:"pure-button",disabled:""===X||q<0||("Row"===X?d:s)<q,onClick:function(){var e,n;"Row"==X?(n=q,v(r.insert_y(n)),f(g())):(e=q,v(r.insert_x(e)),c(w()))},children:"Insert"}),(0,a.jsx)("button",{className:"pure-button",disabled:""===X||q<0||("Row"===X?d:s)<=q||1==("Row"===X?d:s),onClick:function(){var e,n;"Row"==X?(n=q,v(r.remove_y(n)),f(g())):(e=q,v(r.remove_x(e)),c(w()))},children:"Remove"})]}),""!==X&&(0,a.jsxs)("p",{className:"pure-u-1",children:["Insert / Remove a ",X," at ",q]})]})}),(0,a.jsx)("div",{className:"pure-form",children:(0,a.jsxs)("fieldset",{children:[(0,a.jsx)("legend",{children:"Export"}),(0,a.jsxs)("div",{className:"pure-button-group",role:"group",children:[(0,a.jsx)("button",{className:"pure-button",disabled:!n,onClick:function(){var e,n=new Blob([E()]),t=URL.createObjectURL(n),r=document.createElement("a");r.href=t,r.setAttribute("download","export.csvx"),document.body.appendChild(r),r.click(),null===(e=r.parentNode)||void 0===e||e.removeChild(r)},children:"Export as CSVX"}),(0,a.jsx)("button",{className:"pure-button",disabled:!n,onClick:function(){var e,n=new Blob([S()]),t=URL.createObjectURL(n),r=document.createElement("a");r.href=t,r.setAttribute("download","export.csv"),document.body.appendChild(r),r.click(),null===(e=r.parentNode)||void 0===e||e.removeChild(r)},children:"Export as rendered CSV"})]})]})}),(0,a.jsx)("table",{className:"pure-table pure-table-bordered",children:(0,a.jsx)("tbody",{children:b.map((function(e,n){return(0,a.jsx)("tr",{children:e.map((function(e,t){return(0,a.jsx)("td",{title:"("+t+","+n+")",onClick:function(){j(t),C(n),"Row"===X?z(n):"Column"===X&&z(t)},children:e},t)}))},n)}))})})]})}},5301:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(510)}])},3439:function(e,n,t){"use strict";e.exports=t.p+"b82536df8abf8de04fba.wasm"}},function(e){e.O(0,[774,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);