(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3406)}])},3406:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return T}});var r,a=t(5893),i=t(9008),o=t(7294),u=t(8520),s=t.n(u);function c(e,n,t,r,a,i,o){try{var u=e[i](o),s=u.value}catch(c){return void t(c)}u.done?n(s):Promise.resolve(s).then(r,a)}function l(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){c(i,r,a,o,u,"next",e)}function u(e){c(i,r,a,o,u,"throw",e)}o(void 0)}))}}function d(e,n){return null!=n&&"undefined"!==typeof Symbol&&n[Symbol.hasInstance]?n[Symbol.hasInstance](e):e instanceof n}var _=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});_.decode();var f=null;function p(){return null!==f&&f.buffer===r.memory.buffer||(f=new Uint8Array(r.memory.buffer)),f}function b(e,n){return _.decode(p().subarray(e,e+n))}var h=new Array(32).fill(void 0);h.push(void 0,null,!0,!1);var v=h.length;function m(e){v===h.length&&h.push(h.length+1);var n=v;return v=h[n],h[n]=e,n}var w=null;function g(){return null!==w&&w.buffer===r.memory.buffer||(w=new Int32Array(r.memory.buffer)),w}function y(e){var n=function(e){return h[e]}(e);return function(e){e<36||(h[e]=v,v=e)}(e),n}function x(){try{var e=r.__wbindgen_add_to_stack_pointer(-16);r.get_x_size(e);var n=g()[e/4+0],t=g()[e/4+1];if(g()[e/4+2])throw y(t);return n>>>0}finally{r.__wbindgen_add_to_stack_pointer(16)}}function k(){try{var e=r.__wbindgen_add_to_stack_pointer(-16);r.get_y_size(e);var n=g()[e/4+0],t=g()[e/4+1];if(g()[e/4+2])throw y(t);return n>>>0}finally{r.__wbindgen_add_to_stack_pointer(16)}}function j(e,n){try{var t=r.__wbindgen_add_to_stack_pointer(-16);r.get_calculated_item(t,e,n);var a=g()[t/4+0],i=g()[t/4+1],o=g()[t/4+2],u=g()[t/4+3],s=a,c=i;if(u)throw s=0,c=0,y(o);return b(s,c)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(s,c)}}var N=0,C=new TextEncoder("utf-8"),R="function"===typeof C.encodeInto?function(e,n){return C.encodeInto(e,n)}:function(e,n){var t=C.encode(e);return n.set(t),{read:e.length,written:t.length}};function S(e,n,t){try{var a=r.__wbindgen_add_to_stack_pointer(-16),i=function(e,n,t){if(void 0===t){var r=C.encode(e),a=n(r.length);return p().subarray(a,a+r.length).set(r),N=r.length,a}for(var i=e.length,o=n(i),u=p(),s=0;s<i;s++){var c=e.charCodeAt(s);if(c>127)break;u[o+s]=c}if(s!==i){0!==s&&(e=e.slice(s)),o=t(o,i,i=s+3*e.length);var l=p().subarray(o+s,o+i);s+=R(e,l).written}return N=s,o}(t,r.__wbindgen_malloc,r.__wbindgen_realloc),o=N;r.update_item(a,e,n,i,o);var u=g()[a/4+0],s=g()[a/4+1];if(g()[a/4+2])throw y(s);return y(u)}finally{r.__wbindgen_add_to_stack_pointer(16)}}function E(){try{var e=r.__wbindgen_add_to_stack_pointer(-16);r.export_raw_table(e);var n=g()[e/4+0],t=g()[e/4+1],a=g()[e/4+2],i=g()[e/4+3],o=n,u=t;if(i)throw o=0,u=0,y(a);return b(o,u)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(o,u)}}function A(){try{var e=r.__wbindgen_add_to_stack_pointer(-16);r.export_calculated_table(e);var n=g()[e/4+0],t=g()[e/4+1],a=g()[e/4+2],i=g()[e/4+3],o=n,u=t;if(i)throw o=0,u=0,y(a);return b(o,u)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(o,u)}}function I(e,n){return U.apply(this,arguments)}function U(){return(U=l(s().mark((function e(n,t){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof Response||!d(n,Response)){e.next=23;break}if("function"!==typeof WebAssembly.instantiateStreaming){e.next=15;break}return e.prev=2,e.next=5,WebAssembly.instantiateStreaming(n,t);case 5:return e.abrupt("return",e.sent);case 8:if(e.prev=8,e.t0=e.catch(2),"application/wasm"==n.headers.get("Content-Type")){e.next=14;break}console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e.t0),e.next=15;break;case 14:throw e.t0;case 15:return e.next=17,n.arrayBuffer();case 17:return r=e.sent,e.next=20,WebAssembly.instantiate(r,t);case 20:return e.abrupt("return",e.sent);case 23:return e.next=25,WebAssembly.instantiate(n,t);case 25:if(!d(a=e.sent,WebAssembly.Instance)){e.next=30;break}return e.abrupt("return",{instance:a,module:n});case 30:return e.abrupt("return",a);case 31:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function W(e){return L.apply(this,arguments)}function L(){return(L=l(s().mark((function e(n){var a,i,o,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"undefined"===typeof n&&(n=new t.U(t(3439))),(a={}).wbg={},a.wbg.__wbindgen_string_new=function(e,n){return m(b(e,n))},("string"===typeof n||"function"===typeof Request&&d(n,Request)||"function"===typeof URL&&d(n,URL))&&(n=fetch(n)),e.t0=I,e.next=8,n;case 8:return e.t1=e.sent,e.t2=a,e.next=12,(0,e.t0)(e.t1,e.t2);case 12:return i=e.sent,o=i.instance,u=i.module,r=o.exports,W.__wbindgen_wasm_module=u,e.abrupt("return",r);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=W;function P(e,n){for(var t=[],r=0;r<n;r++){for(var a=[],i=0;i<e;i++)a.push(j(i,r));t.push(a)}return t}var T=function(){var e=(0,o.useState)(!1),n=e[0],t=e[1],u=(0,o.useState)(0),s=u[0],c=u[1],l=(0,o.useState)(0),d=l[0],_=l[1],f=(0,o.useState)([]),p=f[0],h=f[1],v=(0,o.useState)(0),m=v[0],w=v[1],j=(0,o.useState)(0),N=j[0],C=j[1],R=(0,o.useState)(""),I=R[0],U=R[1],W=(0,o.useState)(!1),L=W[0],T=W[1],B=(0,o.useState)(""),X=B[0],M=B[1],V=(0,o.useState)(0),q=V[0],z=V[1];return(0,o.useEffect)((function(){n&&U(function(e,n){try{var t=r.__wbindgen_add_to_stack_pointer(-16);r.get_raw_item(t,e,n);var a=g()[t/4+0],i=g()[t/4+1],o=g()[t/4+2],u=g()[t/4+3],s=a,c=i;if(u)throw s=0,c=0,y(o);return b(s,c)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(s,c)}}(m,N))}),[m,N,p]),(0,o.useEffect)((function(){T(n&&0<=m&&m<s&&0<=N&&N<d)}),[p,m,N,s,d]),(0,o.useEffect)((function(){O("/csvx.wasm").then((function(e){e,t(!0),c(x()),_(k())}))}),[]),(0,o.useEffect)((function(){h(P(s,d))}),[s,d]),(0,o.useEffect)((function(){0!=p.length&&0!=p[0].length&&0<=m&&m<s&&0<=N&&N<d&&(S(m,N,I),h(P(s,d)))}),[I]),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.default,{children:(0,a.jsx)("title",{children:"Home | CSVX"})}),(0,a.jsx)("div",{className:"pure-form pure-g",children:(0,a.jsxs)("fieldset",{children:[(0,a.jsx)("legend",{className:"pure-u-1",children:"Edit"}),(0,a.jsx)("input",{value:m,onChange:function(e){w(Number.parseInt(e.target.value))},type:"number",min:"0",placeholder:"x",className:"pure-u-1-12"}),(0,a.jsx)("input",{value:N,onChange:function(e){C(Number.parseInt(e.target.value))},type:"number",min:"0",placeholder:"y",className:"pure-u-1-12"}),(0,a.jsx)("input",{value:I,onChange:function(e){U(e.target.value)},type:"text",placeholder:"value or formula",className:"pure-u-5-6",disabled:!L})]})}),(0,a.jsx)("div",{className:"pure-form pure-g",children:(0,a.jsxs)("fieldset",{children:[(0,a.jsx)("legend",{className:"pure-u-1",children:"Insert / Remove"}),(0,a.jsxs)("select",{value:X,onChange:function(e){return M(e.target.value)},className:"pure-u-1-4",children:[(0,a.jsx)("option",{disabled:!0,value:"",children:"Please Select"}),(0,a.jsx)("option",{children:"Row"}),(0,a.jsx)("option",{children:"Column"})]}),(0,a.jsx)("input",{value:q,onChange:function(e){return z(Number.parseInt(e.target.value))},type:"number",min:"0",placeholder:"position",className:"pure-u-1-4"}),(0,a.jsxs)("div",{className:"pure-button-group pure-u-1-2",role:"group",children:[(0,a.jsx)("button",{className:"pure-button",disabled:""===X||q<0||("Row"===X?d:s)<q,onClick:function(){"Row"==X?(!function(e){try{var n=r.__wbindgen_add_to_stack_pointer(-16);r.insert_y(n,e);var t=g()[n/4+0],a=g()[n/4+1];if(g()[n/4+2])throw y(a);y(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}(q),_(k())):(!function(e){try{var n=r.__wbindgen_add_to_stack_pointer(-16);r.insert_x(n,e);var t=g()[n/4+0],a=g()[n/4+1];if(g()[n/4+2])throw y(a);y(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}(q),c(x()))},children:"Insert"}),(0,a.jsx)("button",{className:"pure-button",disabled:""===X||q<0||("Row"===X?d:s)<=q||1==("Row"===X?d:s),onClick:function(){"Row"==X?(!function(e){try{var n=r.__wbindgen_add_to_stack_pointer(-16);r.remove_y(n,e);var t=g()[n/4+0],a=g()[n/4+1];if(g()[n/4+2])throw y(a);y(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}(q),_(k())):(!function(e){try{var n=r.__wbindgen_add_to_stack_pointer(-16);r.remove_x(n,e);var t=g()[n/4+0],a=g()[n/4+1];if(g()[n/4+2])throw y(a);y(t)}finally{r.__wbindgen_add_to_stack_pointer(16)}}(q),c(x()))},children:"Remove"})]}),""!==X&&(0,a.jsxs)("p",{className:"pure-u-1",children:["Insert / Remove a ",X," at ",q]})]})}),(0,a.jsx)("div",{className:"pure-form",children:(0,a.jsxs)("fieldset",{children:[(0,a.jsx)("legend",{children:"Export"}),(0,a.jsxs)("div",{className:"pure-button-group",role:"group",children:[(0,a.jsx)("button",{className:"pure-button",disabled:!n,onClick:function(){var e,n=new Blob([E()]),t=URL.createObjectURL(n),r=document.createElement("a");r.href=t,r.setAttribute("download","export.csvx"),document.body.appendChild(r),r.click(),null===(e=r.parentNode)||void 0===e||e.removeChild(r)},children:"Export as CSVX"}),(0,a.jsx)("button",{className:"pure-button",disabled:!n,onClick:function(){var e,n=new Blob([A()]),t=URL.createObjectURL(n),r=document.createElement("a");r.href=t,r.setAttribute("download","export.csv"),document.body.appendChild(r),r.click(),null===(e=r.parentNode)||void 0===e||e.removeChild(r)},children:"Export as rendered CSV"})]})]})}),(0,a.jsx)("table",{className:"pure-table pure-table-bordered",children:(0,a.jsx)("tbody",{children:p.map((function(e,n){return(0,a.jsx)("tr",{children:e.map((function(e,t){return(0,a.jsx)("td",{title:"("+t+","+n+")",onClick:function(){w(t),C(n),"Row"===X?z(n):"Column"===X&&z(t)},children:e},t)}))},n)}))})})]})}},3439:function(e,n,t){"use strict";e.exports=t.p+"static/media/csvx_app_bg.fcb68dcd.wasm"}},function(e){e.O(0,[774,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);